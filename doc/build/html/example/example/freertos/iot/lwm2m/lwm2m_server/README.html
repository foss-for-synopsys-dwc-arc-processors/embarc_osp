

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FreeRTOS IoT LwM2M Server &mdash; embARC 2018.12 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/style_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="FreeRTOS Kernel" href="../../../kernel/README.html" />
    <link rel="prev" title="FreeRTOS IoT LwM2M Client" href="../lwm2m_client/README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> embARC
          

          
          </a>

          
            
            
              <div class="version">
                2018.12
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../introduction/introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../arc/arc.html">ARC Processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../device/device.html">Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../board/board.html">Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../os/os.html">Operating Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../middleware/middleware.html">Middleware Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../lib/library.html">Libraries</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../example.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../../../example.html#overview">Overview</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../../example.html">Examples and Demos</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../../baremetal/baremetal_based_example.html">Baremetal examples</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../../os_based_example.html">OS Based Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../example.html#application-note">Application Note</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../developer/developer_guides.html">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../faq/faq.html">Usage Guide FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribute/contribute.html">Contribute to embARC OSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../changelog/changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../bsp/bsp.html">embARC BSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../license/license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">embARC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../example.html">Examples</a> &raquo;</li>
        
          <li><a href="../../../../example.html">Examples and Demos</a> &raquo;</li>
        
          <li><a href="../../../os_based_example.html">OS Based Examples</a> &raquo;</li>
        
      <li>FreeRTOS IoT LwM2M Server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/example/example/freertos/iot/lwm2m/lwm2m_server/README.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="freertos-iot-lwm2m-server">
<span id="example-iot-lwm2m-lwm2m-server"></span><h1>FreeRTOS IoT LwM2M Server<a class="headerlink" href="#freertos-iot-lwm2m-server" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>embARC Example for LwM2M Server on LwIP and FreeRTOS</p>
</div></blockquote>
<div class="section" id="detailed-description">
<h3>Detailed Description<a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt>Extra Required Tools</dt><dd><ul class="simple">
<li><p>Java environment</p></li>
<li><p>Eclipse Leshan</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Extra Required Peripherals</dt><dd><p>Digilent PMOD WIFI (MRF24WG0MA)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Design Concept</dt><dd><p>This example is designed to show how to use LwM2M server in FreeRTOS</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Usage Manual</dt><dd><p>This is an example of OMA LightweightM2M(LwM2M) server. It is not recommended to run lwm2m server on a resource-constrained board. It provides two ntshell commands to show this demo, one is <code class="docutils literal notranslate"><span class="pre">lwm2m_server</span></code> to set up a LwM2M server, and another one is <code class="docutils literal notranslate"><span class="pre">lwm2m_op</span></code> to operate at connected clients.</p>
<p>Like previous <a class="reference internal" href="../lwm2m_client/README.html#example-iot-lwm2m-lwm2m-client"><span class="std std-ref">FreeRTOS IoT LwM2M Client</span></a> example, you’ll need a LwM2M client to test the server. Here we take Eclipse Leshan client for demonstrate use.</p>
<blockquote>
<div><ul class="simple">
<li><p>Eclipse provide a sandbox <a class="reference external" href="https://github.com/eclipse/leshan">leshan client</a></p></li>
<li><p>You can download a standalone <a class="reference external" href="https://hudson.eclipse.org/leshan/job/leshan/lastSuccessfulBuild/artifact/leshan-client-demo.jar">leshan client demo</a> binary from leshan website, and java environment(version &gt;= 1.7.0_75) is required to run this binary</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Extra Comments</dt><dd><p>NO</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="buidling-and-running">
<h2>Buidling and Running<a class="headerlink" href="#buidling-and-running" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>This example outputs to the console. It is supported by all platform. The commands to run this example are as follows:</p>
</div></blockquote>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> &lt;embarc_root&gt;/example/freertos/iot/lwm2m/lwm2m_server
<span class="gp">$</span> make <span class="nv">BOARD</span><span class="o">=</span>emsk <span class="nv">BD_VER</span><span class="o">=</span><span class="m">22</span> <span class="nv">CUR_CORE</span><span class="o">=</span>arcem7d <span class="nv">TOOLCHAIN</span><span class="o">=</span>gnu run
</pre></div>
</div>
<p>Once download the program to the board, you can run command <code class="docutils literal notranslate"><span class="pre">main</span></code> and <code class="docutils literal notranslate"><span class="pre">lwm2m_server</span></code> to start up a LwM2M server at default port 5683. You should also take note of server’s IP address which will be used in next step. Once the server is up, run leshan client demo on your PC.</p>
<p>And here is command to run leshan client demo, you need to change the ip address in command according to your lwm2m_server:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">java -jar leshan-client-demo.jar -u 192.168.137.237</span>
</pre></div>
</div>
<p>Then, you could try out <code class="docutils literal notranslate"><span class="pre">lwm2m_op</span></code> command from server side, and also try to use ‘w, a, s, d’ keys to change the data from leshan client side</p>
<div class="section" id="sample-output">
<h3>Sample Output<a class="headerlink" href="#sample-output" title="Permalink to this headline">¶</a></h3>
<p>Here is sample output from LwM2M server, highlight lines are user input.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">-----------------------------------------------------------</span>
<span class="go"> ____                                _ ____</span>
<span class="go">|  _ \ _____      _____ _ __ ___  __| | __ ) _   _</span>
<span class="go">| |_) / _ \ \ /\ / / _ \ &#39;__/ _ \/ _` |  _ \| | | |</span>
<span class="go">|  __/ (_) \ V  V /  __/ | |  __/ (_| | |_) | |_| |</span>
<span class="go">|_|   \___/ \_/\_/ \___|_|  \___|\__,_|____/ \__, |</span>
<span class="go">                                             |___/</span>
<span class="go">                     _       _    ____   ____</span>
<span class="go">       ___ _ __ ___ | |__   / \  |  _ \ / ___|</span>
<span class="go">      / _ \ &#39;_ ` _ \| &#39;_ \ / _ \ | |_) | |</span>
<span class="go">     |  __/ | | | | | |_) / ___ \|  _ &lt;| |___</span>
<span class="go">      \___|_| |_| |_|_.__/_/   \_\_| \_\\____|</span>
<span class="go">------------------------------------------------------------</span>

<span class="go">embARC Build Time: Apr 16 2018, 14:14:50</span>
<span class="go">Compiler Version: Metaware, 4.2.1 Compatible Clang 4.0.1 (branches/release_40)</span>
<span class="go">FatFS initialized successfully!</span>
<span class="go">Start Init LWIP</span>
<span class="go">ntshell command info(Information) was registered!</span>
<span class="go">ntshell command main(Call main function) was registered!</span>
<span class="go">ntshell command swape(Swap endianness of input variable) was registered!</span>
<span class="go">ntshell command map(Show the memory map of bootloader) was registered!</span>
<span class="go">ntshell command bcr(Dump processor build configuration) was registered!</span>
<span class="go">ntshell command lr(Read auxiliary register) was registered!</span>
<span class="go">ntshell command sr(Write auxiliary register) was registered!</span>
<span class="go">ntshell command mem(Operate the memory) was registered!</span>
<span class="go">ntshell command ledflash(Run led flash example) was registered!</span>
<span class="go">ntshell command led(Write LED) was registered!</span>
<span class="go">ntshell command btn(Read button value) was registered!</span>
<span class="go">ntshell command swt(Read DIP switch value) was registered!</span>
<span class="go">ntshell command ledswbtn(Operate the LED through button and switch) was registered!</span>
<span class="go">ntshell command adc(PMOD ADC sensor demo command) was registered!</span>
<span class="go">ntshell command temp(Show current temperature) was registered!</span>
<span class="go">ntshell command wifi(wifi operations) was registered!</span>
<span class="go">ntshell command ls(List information about files) was registered!</span>
<span class="go">ntshell command cd(Change the working directory) was registered!</span>
<span class="go">ntshell command rm(Remove the file or the folder) was registered!</span>
<span class="go">ntshell command mkdir(Create the directory) was registered!</span>
<span class="go">ntshell command cat(Output file contents) was registered!</span>
<span class="go">ntshell command cp(Copy source to destination) was registered!</span>
<span class="go">ntshell command mv(Rename file or move file) was registered!</span>
<span class="go">ntshell command pwd(Print the current working directory) was registered!</span>
<span class="go">ntshell command touch(Create a file) was registered!</span>
<span class="go">ntshell command ymodem(Ymodem file transfer protocol) was registered!</span>
<span class="go">ntshell command disk(Operate the storge device) was registered!</span>
<span class="go">ntshell command load(Load .bin file from SD card to ram at specified address) was registered!</span>
<span class="go">ntshell command boot(Load application specified in a boot.cfg file from sdcard and run) was registered!</span>
<span class="go">ntshell command go(Run the program at the specified address) was registered!</span>
<span class="go">ntshell command spirw(Read/Write the image in spi flash for updating bootloader/application image) was registered!</span>
<span class="go">ntshell command mload(Update firmware, read or write MCS file in the SPI flash) was registered!</span>
<span class="go">NTShell Task StartUp</span>
<span class="go">COM1&gt;</span>
<span class="go">Now trying to connect to WIFI hotspot, please wait about 30s!</span>
<span class="go">MRF24G Device Information As Follows:</span>
<span class="go">Device Type:2, ROM Ver:31, Patch Ver:7</span>
<span class="go">Connection Profile ID:1</span>
<span class="go">WF INIT SUCCESSFULL!</span>
<span class="go">MRF24G MAC ADDRESS:00-1e-c0-0e-6e-0a</span>
<span class="go">WF_EVENT_CONNECTION_SUCCESSFUL</span>
<span class="go">Link is UP!</span>

<span class="go">Now start get ip address using DHCP, Please wait about 30s!</span>

<span class="go">-----PMOD WIFI IP ADDRESS INFO-----</span>
<span class="go"> ipaddr 192.168.137.237 netmask 255.255.255.0 gw 192.168.137.1</span>
<span class="go"> dns server 0 :192.168.137.1</span>
<span class="go"> dns server 1 :0.0.0.0</span>
<span class="go">-----------------------------------</span>
<span class="go">WiFi connected</span>
<span class="go">Please run NT-Shell command(main) to start your application.</span>
<span class="go">main command may required some arguments, please refer to example&#39;s document.</span>
<span class="hll"><span class="go">main</span>
</span><span class="go">Start FreeRTOS LwM2M Client Demo by run lwm2m_server and lwm2m_op command</span>
<span class="go">ntshell command lwm2m_server(Start LwM2M server) was registered!</span>
<span class="go">ntshell command lwm2m_op(do some operations when LwM2M server is online) was registered!</span>
<span class="hll"><span class="go">COM1&gt;lwm2m_server</span>
</span><span class="go">Start LwM2M server.Try to start LwM2M server using port 5683.</span>
<span class="go">COM1&gt;107 bytes received from [192.168.137.1]:55130</span>
<span class="go">  48 02 49 22 82 65 BD 10 CB FB 20 10 B2 72 64 11   H . I &quot; . e . . . .   . . r d .</span>
<span class="go">  28 33 62 3D 55 09 6C 77 6D 32 6D 3D 31 2E 30 05   ( 3 b = U . l w m 2 m = 1 . 0 .</span>
<span class="go">  6C 74 3D 33 30 0D 01 65 70 3D 65 6D 62 41 52 43   l t = 3 0 . . e p = e m b A R C</span>
<span class="go">  2D 74 65 73 74 FF 3C 2F 3E 3B 72 74 3D 22 6F 6D   - t e s t . &lt; / &gt; ; r t = &quot; o m</span>
<span class="go">  61 2E 6C 77 6D 32 6D 22 2C 20 3C 2F 31 2F 30 3E   a . l w m 2 m &quot; ,   &lt; / 1 / 0 &gt;</span>
<span class="go">  2C 20 3C 2F 33 2F 30 3E 2C 20 3C 2F 36 2F 30 3E   ,   &lt; / 3 / 0 &gt; ,   &lt; / 6 / 0 &gt;</span>
<span class="go">  2C 20 3C 2F 33 33 30 33 2F 30 3E                  ,   &lt; / 3 3 0 3 / 0 &gt;</span>

<span class="go">New client #0 registered.</span>
<span class="go">Client #0:</span>
<span class="go">        name: &quot;embARC-test&quot;</span>
<span class="go">        binding: &quot;UDP&quot;</span>
<span class="go">        lifetime: 30 sec</span>
<span class="go">        objects: /1/0, /3/0, /6/0, /3303/0,</span>

<span class="go">17 bytes received from [192.168.137.1]:55130</span>
<span class="go">  48 02 49 23 F0 E4 4F 93 1E CE F0 06 B2 72 64 01   H . I # . . O . . . . . . r d .</span>
<span class="go">  30                                                0</span>

<span class="go">Client #0 updated.</span>
<span class="go">Client #0:</span>
<span class="go">        name: &quot;embARC-test&quot;</span>
<span class="go">        binding: &quot;UDP&quot;</span>
<span class="go">        lifetime: 30 sec</span>
<span class="go">        objects: /1/0, /3/0, /6/0, /3303/0,</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../../kernel/README.html" class="btn btn-neutral float-right" title="FreeRTOS Kernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../lwm2m_client/README.html" class="btn btn-neutral float-left" title="FreeRTOS IoT LwM2M Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Synopsys

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>