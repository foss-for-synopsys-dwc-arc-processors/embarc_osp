<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>embARC: ARC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 50px;">
  <td id="projectlogo"><img alt="Logo" src="embARC_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectnumber">2017.03</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_arc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ARC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sect_arc_description">Description</a></li>
<li class="level1"><a href="#sect_arc_startup">Startup</a><ul><li class="level2"><a href="#sect_arc_startup_in_embARC">Startup in embARC</a></li>
<li class="level2"><a href="#sect_arc_startup_scenarios">Startup scenarios</a></li>
</ul>
</li>
<li class="level1"><a href="#sect_arc_exception_and_interrupt">Exceptions and Interrupts</a><ul><li class="level2"><a href="#sect_arc_exception_and_interrupt_intro">ARC exceptions and interrupts</a></li>
<li class="level2"><a href="#sect_arc_exception_and_interrupt_in_embARC">Exception and interrupt processing in embARC</a></li>
</ul>
</li>
<li class="level1"><a href="#sect_arc_builtin_functions">Built-In Functions</a></li>
<li class="level1"><a href="#sect_arc_resource_definitions">Resource Definitions</a></li>
<li class="level1"><a href="#sect_arc_access_to_resources">Access to Resources</a><ul><li class="level2"><a href="#sect_arc_resources_internal_timers">Internal timers</a></li>
<li class="level2"><a href="#sect_arc_resources_internal_cache">Caches</a></li>
<li class="level2"><a href="#sect_arc_resources_internal_uDMA">uDMA</a></li>
</ul>
</li>
<li class="level1"><a href="#sect_arc_related_files">Related Files</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sect_arc_description"></a>
Description</h1>
<p>The ARC <b>Hardware Abstraction Layer</b> (HAL) provides hardware abstraction for ARC EM processors. In this layer, the following functions are provided: <br />
</p><ul>
<li><b>Startup</b>: common startup routines or templates to handle necessary initializations after power on, reset, and so on. <br />
</li>
<li><b>Exception and interrupt management</b>: a standard exception and interrupt processing model and related resource definitions. <br />
</li>
<li><b>Unified intrinsic/built-in functions</b>: covering both the MetaWare and GNU toolchains. <br />
</li>
<li><b>Unified resource definitions</b>: registers, data types, macros, and so on. <br />
</li>
<li><b>Access to the resources</b>: internal timers, cache, auxiliary registers, and build configuration registers. <br />
 </li>
</ul>
<h1><a class="anchor" id="sect_arc_startup"></a>
Startup</h1>
<h2><a class="anchor" id="sect_arc_startup_in_embARC"></a>
Startup in embARC</h2>
<p>The startup process is implemented in <a class="el" href="arc__startup_8s_source.html">arc_startup.s</a>. The program jumps to the <a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___a_r_c___f_e_a_t_u_r_e___a_x_s103.html#ga840291bc02cba5474a4cb46a9b9566fe" title="main entry for testing arc fiq interrupt ">main()</a> function after the startup process, which runs in three stages: </p><ul>
<li>
<b>Stage 1: Hardware Initialization</b> <ul>
<li>
Initialize system clock (if necessary, in hardware_init_hook). </li>
<li>
Initialize memory controller (if necessary, in hardware_init_hook). </li>
</ul>
</li>
<li>
<b>Stage 2: C Run-time Initialization</b> <ul>
<li>
Initialize setup stack. </li>
<li>
Copy section. </li>
<li>
Clear Block Started by Symbol (BSS) section. </li>
</ul>
</li>
<li>
<b>Stage 3: Go to <a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___a_r_c___f_e_a_t_u_r_e___a_x_s103.html#ga840291bc02cba5474a4cb46a9b9566fe" title="main entry for testing arc fiq interrupt ">main()</a></b> <ul>
<li>
Early initialization of software (if necessary, in software_init_hook). </li>
<li>
Call arc_exc_init. </li>
<li>
Jump to <a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___a_r_c___f_e_a_t_u_r_e___a_x_s103.html#ga840291bc02cba5474a4cb46a9b9566fe" title="main entry for testing arc fiq interrupt ">main()</a> function. </li>
</ul>
</li>
</ul>
<p> 
<div class="imagebox">
    <div style="width: 500px">
        <img src="pic/startup.jpg" alt="Startup Process"/>
        <p>Startup Process</p>
    </div>
</div>
</p>
<p>Use of assembly is preferred in startup routines for performance. Special C code without any use of stack or variables is another alternative. You can customize the startup process to include other aspects, such as C++ initialization.</p>
<h2><a class="anchor" id="sect_arc_startup_scenarios"></a>
Startup scenarios</h2>
<p>The following startup scenarios are supported in the startup module: </p><ul>
<li>
<b>Load and run in RAM</b> <ul>
<li>
Object files are loaded and run in RAM. </li>
<li>
There is no need to initialize the hardware in this case. </li>
<li>
Only the BSS section should be cleared. </li>
<li>
Template: generic_ram.ld/.met. </li>
<li>
Examples: loaded by a bootloader such as u-boot. </li>
</ul>
</li>
<li>
<b>Load and run in ROM</b> <ul>
<li>
Object files are loaded and run in ROM. </li>
<li>
It is necessary to initialize hardware in this case. </li>
<li>
Data section should be copied and BSS section should be cleared. </li>
<li>
Template: generic_rom.ld/.met. </li>
<li>
Examples: eXecute In Place(XIP). </li>
</ul>
</li>
<li>
<b>Load in ROM and run in RAM</b> <ul>
<li>
Object files are loaded in ROM and run in RAM. </li>
<li>
A fixed bootstrap is needed. </li>
<li>
Text section and data section must be copied, and BSS section must be cleared. </li>
<li>
Template: generic_rom_ram.ld/.met. </li>
<li>
Examples: application is put in SPI flash. </li>
</ul>
</li>
<li>
<b>Debug</b> <ul>
<li>
Debugger can initialize hardware, copy test section and data section, and clear BSS section. </li>
<li>
No template is provided. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="sect_arc_exception_and_interrupt"></a>
Exceptions and Interrupts</h1>
<h2><a class="anchor" id="sect_arc_exception_and_interrupt_intro"></a>
ARC exceptions and interrupts</h2>
<p>ARC EM processors are designed to allow exceptions to be taken and handled by interrupt service routines in user or kernel mode. All exceptions and interrupts cause an immediate switch into kernel mode. Interrupts are disabled on entry to an exception handler. <br />
Exceptions can be divided into two types: CPU exceptions and interrupt exceptions. CPU exceptions are triggered by errors such as illegal instructions, invalid or illegal memory accesses, and protection violations. Most CPU exceptions are synchronous. Interrupt exceptions are triggered by device interrupts and are always asynchronous. <br />
Exception vectors are fetched in the instruction space (ICCM or main memory, but not DCCM). Every exception contains the following information: <br />
</p><ul>
<li>
<b>Vector Name</b> is a symbolic equivalent of the vector number. <br />
 </li>
<li>
<b>Vector Number</b> is a unique eight-bit index in the exception or interrupt vector table. <br />
 </li>
<li>
<b>Vector Offset</b> is an offset value calculated as four times the vector number (vector offset = 4*vector_number), which is used to determine the position of the appropriate exception or interrupt service routine. <br />
 </li>
<li>
<b>Cause Code</b> is an eight-bit number to identify the exact cause of an exception. <br />
 </li>
<li>
<b>Parameter</b> is an eight-bit field to pass a single parameter from the exception to the exception handler and identify exceptions with the same cause code. <br />
</li>
</ul>
<p>For more details, see the <b><em>ARCv2 ISA Programmer's Reference Manual</em> (PRM)</b>.</p>
<h2><a class="anchor" id="sect_arc_exception_and_interrupt_in_embARC"></a>
Exception and interrupt processing in embARC</h2>
<p>A basic exception and interrupt processing framework is implemented in embARC. Through this framework, you can handle specific exceptions or interrupts by installing the desired handlers. This can help you analyze the underlying details of saving and operating registers. <br />
For CPU exceptions and interrupts, <b>entry</b> is called first, then <b>handler</b> is called in <b>entry</b>. You can define your own entry using <b>exc_entry_install</b>. <br />
A standard interrupt processing model is shown in the picture below. <br />
  
<div class="imagebox">
    <div style="width: 600px">
        <img src="pic/interrupt.jpg" alt="Interrupt Processing"/>
        <p>Interrupt Processing</p>
    </div>
</div>
</p>
<p>In this model, interrupts have the following features: <br />
</p><ul>
<li>
Devices request interrupts through their own interrupt vectors and they can share the same interrupt vectors. <br />
 </li>
<li>
An interrupt can be level-sensitive or pulse-sensitive. <br />
 </li>
<li>
An interrupt can be enabled (unmasked) and disabled (masked). <br />
 </li>
<li>
The priority of each interrupt can be programmed by software. <br />
 </li>
<li>
Interrupt priority order is from INT_PRI_HIGH (highest, -1 default) to INT_PRI_MIN (lowest, -2 default). <br />
 </li>
<li>
CPU lock and unlock are used to disable and enable interrupt processing. <br />
</li>
</ul>
<p>For most Real-Time Operating Systems (RTOS), the task/process/thread priority is a positive number and starts from 1 (the highest priority). <br />
Negative numbers are used to define a unified priority scheme in embARC. Priority 0 (highest priority) is always assigned to the OS scheduler. A higher-priority task can preempt a lower-priority task. The OS scheduler can preempt any other tasks. But interrupt handling tasks with negative numbers cannot be scheduled or switched by the OS scheduler.</p>
<h1><a class="anchor" id="sect_arc_builtin_functions"></a>
Built-In Functions</h1>
<p>Compiler built-in functions are used to invoke certain processor operations without writing assembly code. In embARC, a series of built-in functions is provided in both the MetaWare and GNU toolchains. <br />
See <a class="el" href="arc__builtin_8h.html" title="header file of builtin and helper functions ">arc_builtin.h</a> for further details.</p>
<h1><a class="anchor" id="sect_arc_resource_definitions"></a>
Resource Definitions</h1>
<p>The structure of resource definitions is architecture-&gt;series-&gt;processor-&gt;board. <br />
<a class="el" href="arc_8h.html" title="header file including common core definitions ">arc.h</a> includes the common resource definitions for the ARC EM architecture, such as macros for exceptions and auxiliary register access. <br />
<a class="el" href="arc__em_8h.html" title="header file of EM series ">arc_em.h</a> includes the common resource definitions for ARC EM Processors.</p>
<h1><a class="anchor" id="sect_arc_access_to_resources"></a>
Access to Resources</h1>
<h2><a class="anchor" id="sect_arc_resources_internal_timers"></a>
Internal timers</h2>
<p>ARC EM processors have two independent 32-bit timers and a 64-bit real-time counter (RTC). Timer 0 and Timer 1 are identical in operation. The only difference is that these timers are connected to different interrupts. Each timer is optional with a fixed interrupt: interrupt 16 for timer 0 and interrupt 17 for timer 1. <br />
The internal timers are connected to a system clock signal that always runs even when the ARC EM processor is in the SLEEP state. The timers can be used to generate interrupt signals that wake the processor from the SLEEP state. The processor timers automatically reset and restart after reaching the limit value. The processor timers can be programmed to count the clock cycles only if the processor is not halted. The processor timers can also be programmed to generate an interrupt or a system reset if they reach the limit value. The 64-bit RTC cannot generate any interrupts. This timer is used to count the clock cycles automatically. <br />
 embARC provides interfaces for internal timers such as start, stop, poll, and read.</p>
<h2><a class="anchor" id="sect_arc_resources_internal_cache"></a>
Caches</h2>
<p>ARC EM processors can be configured with both data cache (dcache) and instruction cache (icache). The cache configuration can be selected as desired. The cache can be controlled through specific auxiliary registers. <br />
embARC provides unified interfaces to enable/disable, flush, invalidate, lock, and unlock cache lines and to access cache-internal RAM. See <a class="el" href="arc__cache_8h.html" title="header file of cache module ">arc_cache.h</a> for further details.</p>
<h2><a class="anchor" id="sect_arc_resources_internal_uDMA"></a>
uDMA</h2>
<p>The EM DMA controller is an optional high performance, low area/energy consumption DMA engine for use in the ARC EM 2.0 cores.<br />
The DMA controller supports the following features: <br />
</p><ul>
<li>1 to 16 independent programmable DMA channels (number of channels is configurable)</li>
<li>User-programmable prioritization scheme for all available channels</li>
<li>Concurrent operation with the CPU</li>
<li>Software/Hardware&ndash;triggered DMA transfers</li>
<li>Two addressing modes</li>
<li>Five data transfer modes (configurable down to one)</li>
<li>Internal and external interrupt support</li>
</ul>
<h1><a class="anchor" id="sect_arc_related_files"></a>
Related Files</h1>
<p>The files relevant to the ARC EM processor in the <b>embARC software package</b> are described in the table below. <br />
 </p><table class="doxtable">
<tr>
<th align="center">File/Folder </th><th align="center">Content  </th></tr>
<tr>
<td align="center"><a class="el" href="arc_8h.html" title="header file including common core definitions ">arc.h</a>, <a class="el" href="arc__em_8h.html" title="header file of EM series ">arc_em.h</a>, <a class="el" href="arc__hs_8h.html" title="header file of HS series ">arc_hs.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___c_o_r_e.html">Processor resources definition</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__asm__common_8h.html" title="common macro definitions for assembly file ">arc_asm_common.h</a> </td><td align="center">Common macro definitions for assembly code </td></tr>
<tr>
<td align="center"><a class="el" href="arc__builtin_8h.html" title="header file of builtin and helper functions ">arc_builtin.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___b_u_i_l_t_i_n.html">Compiler built-in and helper functions</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__cache_8c.html" title="implementation of cache related functions ">arc_cache.c</a>, <a class="el" href="arc__cache_8h.html" title="header file of cache module ">arc_cache.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___m_i_s_c___c_a_c_h_e.html">ARC cache module</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__exc__asm_8s_source.html">arc_exc_asm.s</a> </td><td align="center"><a class="el" href="page_arc.html#sect_arc_exception_and_interrupt">Assembly part of exception handling</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__exception_8c.html" title="C Implementation of exception and interrupt management. ">arc_exception.c</a>, <a class="el" href="arc__exception_8h.html" title="header file of exception and interrupt management module ">arc_exception.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___e_x_c_e_p_t_i_o_n.html">ARC CPU exception and interrupt exception module</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__startup_8s_source.html">arc_startup.s</a> </td><td align="center"><a class="el" href="page_arc.html#sect_arc_startup">Common startup routine</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__timer_8c.html" title="implementation of internal timer related functions ">arc_timer.c</a>, <a class="el" href="arc__timer_8h.html" title="header file of ARC internal timer ">arc_timer.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___m_i_s_c___t_i_m_e_r.html">ARC internal timer module</a> </td></tr>
<tr>
<td align="center"><a class="el" href="arc__udma_8c.html" title="API implementation for DMA Controller for ARC. ">arc_udma.c</a>, <a class="el" href="arc__udma_8h.html" title="header file of ARC uDMA driver ">arc_udma.h</a>, <a class="el" href="arc__udma__config_8h.html" title="Configurations of uDMA controller. ">arc_udma_config.h</a> </td><td align="center"><a class="el" href="group___a_r_c___h_a_l___m_i_s_c___u_d_m_a.html">ARC uDMA module</a> </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Mar 23 2017 16:14:37 for embARC by
    <a href="http://www.synopsys.com">
    <img class="footer" src="pic/snps_logo.png" alt="snps_logo"/></a>. All Rights Reserved. </li>
  </ul>
</div>
</body>
</html>
